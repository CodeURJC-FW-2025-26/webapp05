<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TCG DEVS</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Personalized CSS -->
    <link href="style/style.css" rel="stylesheet">
</head>

<body>
    {{> header}}

    <!-- MAIN CARD SECTION -->
    <main class="store-main" id="cartas">
        <div class="container py-5">
            <!-- Section title -->
            <div class="row mb-5">
                <div class="col-12 text-center">
                    <h2 class="section-title">Our Pokemon Cards</h2>
                    <p class="section-subtitle">Discover the best sellers</p>
                    <!-- Search form -->
                    <form class="d-flex justify-content-center mt-3" method="get" action="/">
                        <input name="q" value="{{q}}" class="form-control me-2" style="max-width:420px;" type="search"
                            placeholder="Buscar por nombre" aria-label="Search">
                        <button class="btn btn-outline-primary search-btn" type="submit">Buscar</button>
                    </form>

                    <!-- Filters: collections and price ranges -->
                    <div class="d-flex justify-content-center gap-2 mt-3 flex-wrap">
                        <!-- Collections -->
                        {{#collections}}
                        <a href="/?collection={{name}}{{#q}}&q={{q}}{{/q}}{{#price}}&price={{value}}{{/price}}"
                            class="btn btn-sm btn-outline-secondary filter-btn {{#current}}active{{/current}}">{{name}}</a>
                        {{/collections}}

                        <!-- Price ranges -->
                        <a href="/?price=lt10{{#q}}&q={{q}}{{/q}}{{#collection}}&collection={{collection}}{{/collection}}"
                            class="btn btn-sm btn-outline-secondary filter-btn {{#price}}{{#is_lt10}}active{{/is_lt10}}{{/price}}">&lt;
                            €10</a>
                        <a href="/?price=10-50{{#q}}&q={{q}}{{/q}}{{#collection}}&collection={{collection}}{{/collection}}"
                            class="btn btn-sm btn-outline-secondary filter-btn {{#price}}{{#is_10_50}}active{{/is_10_50}}{{/price}}">€10
                            - €50</a>
                        <a href="/?price=gt50{{#q}}&q={{q}}{{/q}}{{#collection}}&collection={{collection}}{{/collection}}"
                            class="btn btn-sm btn-outline-secondary filter-btn {{#price}}{{#is_gt50}}active{{/is_gt50}}{{/price}}">&gt;
                            €50</a>

                        <!-- Clear filters -->
                        <a href="/" class="btn btn-sm btn-outline-dark">Ver todo</a>
                    </div>
                </div>
            </div>

            <!-- Card Grid (rendered from DB posts) -->
            <div class="row cards-grid">
                {{#posts}}
                <div class="col-lg-4 col-md-6 col-xs-12 mb-4">
                    <div class="pokemon-card">
                        <div class="card-image">
                            <img src="/uploads/{{imageFilename}}" alt="{{title}}" class="card-img">
                            <div class="card-overlay">
                                <a href="/post/{{_id}}" class="btn-view-details">See Details</a>
                            </div>
                        </div>
                        <div class="card-content">
                            <h3 class="card-title">{{title}}</h3>
                            <div class="card-collection">{{coleccion}}</div>
                            <div class="card-price">€{{precio}}</div>
                        </div>
                    </div>
                </div>
                {{/posts}}
            </div>
            <!-- Pagination -->
            <div class="row mt-4">
                <div class="col-12 d-flex justify-content-center">
                    <nav aria-label="Page navigation">
                        <ul class="pagination">
                            <li class="page-item {{^hasPrev}}disabled{{/hasPrev}}">
                                <a class="page-link"
                                    href="{{#hasPrev}}/?page={{prevPage}}{{#q}}&q={{q}}{{/q}}{{#collection}}&collection={{collection}}{{/collection}}{{#price}}&price={{value}}{{/price}}{{/hasPrev}}{{^hasPrev}}#{{/hasPrev}}">Prev</a>
                            </li>

                            {{#pages}}
                            <li class="page-item {{#current}}active{{/current}}">
                                <a class="page-link"
                                    href="/?page={{num}}{{#q}}&q={{q}}{{/q}}{{#collection}}&collection={{collection}}{{/collection}}{{#price}}&price={{value}}{{/price}}"
                                    {{#current}}aria-current="page" {{/current}}>{{num}}</a>
                            </li>
                            {{/pages}}

                            <li class="page-item {{^hasNext}}disabled{{/hasNext}}">
                                <a class="page-link"
                                    href="{{#hasNext}}/?page={{nextPage}}{{#q}}&q={{q}}{{/q}}{{#collection}}&collection={{collection}}{{/collection}}{{#price}}&price={{value}}{{/price}}{{/hasNext}}{{^hasNext}}#{{/hasNext}}">Next</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>

            <a href="/create_new_card.html" class="btn-view-addCards">Add Cards</a>
        </div>
    </main>

    {{> footer}}

</body>

</html>